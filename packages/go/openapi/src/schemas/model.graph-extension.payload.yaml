# Copyright 2026 Specter Ops, Inc.
#
# Licensed under the Apache License, Version 2.0
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#
# SPDX-License-Identifier: Apache-2.0

type: object
properties:
  schema:
    type: object
    properties:
      name:
        type: string
        example: OpenGraph_Extension
      display_name:
        type: string
        example: OpenGraph Extension
      version:
        type: string
        example: 1.0.0
      namespace:
        type: string
        example: OGE
  node_kinds:
    type: array
    items:
      type: object
      properties:
        name:
          type: string
          example: OGE_Computer
        display_name:
          type: string
          example: Computer
        description:
          type: string
          example: An Open Graph Extension Computer object
        is_display_kind:
          type: boolean
        icon:
          type: string
          example: Desktop
        color:
          type: string
          example: "#FF0000"
  relationship_kinds:
    type: array
    items:
      type: object
      properties:
        name:
          type: string
          example: OGE_ConnectedTo
        description:
          type: string
          example: An OpenGraph Extension ConnectedTo edge
        is_traversable:
          type: boolean
  #properties:
  #  type: array
  #  items:
  #    type: object
  #    properties:
  #      name:
  #        type: string
  #        example: UserPrincipalName
  #      display_name:
  #        type: string
  #        example: User Principal Name
  #      data_type:
  #        type: string
  #        example: string
  #      description:
  #        type: string
  #        example: An Active Directory User Principal Name
  environments:
    type: array
    items:
      type: object
      properties:
        environment_kind:
          type: string
          example: OGE_Environment
        source_kind:
          type: string
          example: SourceKind
        principal_kinds:
          type: array
          items:
            type: string
          example:
            - OGE_User
            - OGE_Computer
  relationship_findings:
    type: array
    items:
      type: object
      properties:
        name:
          type: string
          example: OGE_Malicious_Finding_1
        display_name:
          type: string
          example: Malicious Finding 1
        source_kind:
          type: string
          example: Base
        relationship_kind:
          type: string
          example: OGE_ConnectedTo
        environment_kind:
          type: string
          example: OGE_Environment
        remediation:
          type: object
          properties:
            short_description:
              type: string
            long_description:
              type: string
            short_remediation:
              type: string
            long_remediation:
              type: string
